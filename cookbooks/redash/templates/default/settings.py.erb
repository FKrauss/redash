"""
Settings module generated and dropped off by Chef.
Will be overwritten.
"""

import django.conf

REDIS_URL = "<%= node['redash']['redis_url'] %>"
# Connection string for the database that is used to run queries against
CONNECTION_STRING = "user=<%= node['redash']['db']['user'] %> password=<%= node['redash']['db']['password'] %> host=<%= node['redash']['db']['host'] %> port=<%= node['redash']['db']['port'] %> dbname=<%= node['redash']['db']['dbname'] %>"
# Connection string for the operational databases (where we store the queries, results, etc)
INTERNAL_DB_CONNECTION_STRING = "user=<%= node['redash']['cfg']['user'] %> password=<%= node['redash']['cfg']['password'] %> host=<%= node['redash']['cfg']['host'] %> port=<%= node['redash']['cfg']['port'] %> dbname=<%= node['redash']['cfg']['dbname'] %>"
# Google Apps domain to allow access from; any user with email in this Google Apps will be allowed
# access
GOOGLE_APPS_DOMAIN = "<%= node['redash']['allow']['google_app_domain'] %>"
# Email addresses of specific users not from the above set Google Apps Domain, that you want to
# allow access to re:dash
ALLOWED_USERS = <%= Chef::JSONCompat.to_json node['redash']['allow']['google_app_users'] %>
# Email addresses of admin users
ADMINS = <%= Chef::JSONCompat.to_json node['redash']['allow']['admins'] %>

STATIC_ASSETS_PATH = "<%= node['redash']['install_path'] %>/rd_ui/dist/"

WORKERS_COUNT   = <%= node['redash']['workers_count'] %>
MAX_CONNECTIONS = <%= node['redash']['max_connections'] %>

COOKIE_SECRET   = "c292a0a3aa32397cdb050e233733900f"

# Configuration of the operational database for the Django models
django.conf.settings.configure(DATABASES = { 'default': {
        'ENGINE':    'dbpool.db.backends.postgresql_psycopg2',
        'OPTIONS':  {'MAX_CONNS': <%= node['redash']['max_connections'] %>, 'MIN_CONNS': 1},
        'NAME':     '<%= node['redash']['db']['dbname'] %>',
        'USER':     '<%= node['redash']['db']['user'] %>',
        'PASSWORD': '<%= node['redash']['db']['password'] %>',
        'HOST':     '<%= node['redash']['db']['host'] %>',
        'PORT':     '<%= node['redash']['db']['port'] %>',
        },}, TIME_ZONE = 'UTC')
